# Phase 1: Foundation & Code Quality - Research

**Researched:** 2026-02-05
**Domain:** Next.js 15 + React 19 + TypeScript code quality tooling
**Confidence:** HIGH

## Summary

Phase 1 establishes the code quality foundation for a Next.js 15 project using modern tooling (ESLint 9 flat config, Prettier, Husky, TypeScript strict mode). The research reveals clear consensus on the standard stack and configuration patterns across the ecosystem. All major tools have moved to flat config / explicit configuration formats by 2026.

**Key findings:**
- ESLint 9 with flat config (eslint.config.mjs) is the only supported path forward; old .eslintrc is deprecated
- TypeScript strict mode is enabled via `"strict": true` plus 3-4 additional strict options (noUncheckedIndexedAccess recommended)
- Prettier integration uses eslint-config-prettier positioned last in the config array (NOT eslint-plugin-prettier)
- Husky + lint-staged runs pre-commit checks on staged files only, preventing bad commits
- GitHub Actions automate linting, type-checking, and testing on PR/main; Vercel integrates natively or via Actions
- pnpm is 3.7x faster than npm (12.4s vs 46.1s for ~1,200 dependencies) and prevents phantom dependencies
- React 19's new rules for hooks require eslint-plugin-react-hooks v5.0.0+; React Compiler lint rules still being finalized

**Primary recommendation:** Use ESLint 9 flat config with eslint-config-next/core-web-vitals, add eslint-config-prettier/flat, enable TypeScript strict mode with recommended extensions, configure Husky pre-commit hooks, and set up GitHub Actions workflows for PR checks.

## Standard Stack

### Core Tooling

| Tool | Version | Purpose | Why Standard |
|------|---------|---------|--------------|
| **ESLint** | 9.x | JavaScript/TypeScript linting | Industry standard; flat config now mandatory; built-in Next.js support via @next/eslint-plugin-next |
| **eslint-config-next** | ^15.x | Next.js + React + Hooks rules | Vercel-maintained; includes @next/eslint-plugin-next, eslint-plugin-react, eslint-plugin-react-hooks |
| **TypeScript** | 5.x+ | Type checking | React 19 requires 5.x; strict mode catches errors at compile-time |
| **Prettier** | 3.x+ | Code formatting | Standardizes whitespace, quotes, semicolons; decoupled from linting |
| **eslint-config-prettier** | 9.x+ | Disables ESLint style rules | Prevents ESLint ↔ Prettier conflicts; must use `/flat` suffix for flat config |
| **Husky** | 9.x+ | Git hooks manager | Industry standard for pre-commit checks; auto-installed via prepare script |
| **lint-staged** | 15.x+ | Runs linters on staged files | Prevents bad commits; only lints changed files (fast) |

### Installation

```bash
# Package manager (project uses pnpm, 3.7x faster than npm)
pnpm install -D eslint eslint-config-next@latest @typescript-eslint/eslint-plugin @typescript-eslint/parser

# Formatting + conflict resolution
pnpm install -D prettier eslint-config-prettier@latest

# Git hooks
pnpm install -D husky lint-staged

# Initialize Husky
npx husky install
```

### Configuration Files Required

```
project-root/
├── eslint.config.mjs              # ESLint 9 flat config (replaces .eslintrc)
├── .prettierrc.json               # Prettier configuration
├── prettier.config.mjs            # (Alternative) Prettier config in JS
├── .lintstagedrc.json             # lint-staged configuration
├── .husky/
│   └── pre-commit                 # Git hook script (auto-generated by husky)
├── tsconfig.json                  # TypeScript with strict mode enabled
├── next.config.js                 # (Note: eslint option removed in Next.js 16+)
└── package.json                   # prepare script: "husky install"
```

### Supporting Libraries

| Library | Version | Purpose | When to Use |
|---------|---------|---------|-------------|
| **@typescript-eslint/eslint-plugin** | ^7.x | TypeScript linting rules | Required when using TypeScript |
| **@typescript-eslint/parser** | ^7.x | Parses TypeScript into AST | Required when using TypeScript |
| **eslint-plugin-react-hooks** | ^5.x+ | Validates React Hooks rules | Included in eslint-config-next; enforces dependencies array, Rules of Hooks |

### Alternatives Considered

| Instead of | Could Use | Tradeoff |
|------------|-----------|----------|
| ESLint 9 flat config | Old .eslintrc format with ESLINT_USE_FLAT_CONFIG=false | Legacy escape hatch only; deprecated; will break in future versions |
| eslint-config-prettier | eslint-plugin-prettier | Plugin is slower, produces excessive editor warnings, more complex; Prettier author explicitly discourages it |
| Husky | Manual git hooks scripts | No auto-installation on clone; team must remember to run setup; error-prone |
| pnpm | npm or yarn | npm is ~3.7x slower; yarn is also slower than pnpm; pnpm is consensus choice in 2026 for monorepos and modern stacks |
| Standalone ESLint | Biome (unified linter + formatter) | Biome is fast but immature; not yet widely adopted for Next.js; ESLint + Prettier is proven and compatible |

## Architecture Patterns

### Recommended Project Structure

**Strategy: Colocate with features, keep app/ directory lean**

```
src/
├── app/                          # Next.js App Router (routing only)
│   ├── (auth)/                  # Route group (doesn't affect URL)
│   │   ├── login/
│   │   │   └── page.tsx
│   │   ├── register/
│   │   │   └── page.tsx
│   │   └── layout.tsx
│   ├── (marketing)/
│   │   ├── page.tsx
│   │   └── layout.tsx
│   ├── dashboard/
│   │   ├── page.tsx
│   │   └── layout.tsx
│   ├── api/                     # API routes (route.ts)
│   │   └── users/route.ts
│   ├── layout.tsx               # Root layout
│   └── page.tsx                 # Home page
│
├── components/                   # Reusable UI components (atomic design)
│   ├── atoms/
│   │   ├── Button.tsx
│   │   └── Input.tsx
│   ├── molecules/
│   │   ├── LoginForm.tsx
│   │   └── UserCard.tsx
│   └── organisms/
│       └── Navigation.tsx
│
├── lib/                         # Business logic, utilities, helpers
│   ├── auth.ts                 # Authentication logic
│   ├── api-client.ts           # API request wrapper
│   ├── db.ts                   # Database client setup
│   ├── utils.ts                # General utilities
│   └── constants.ts            # App constants
│
├── hooks/                       # Custom React hooks
│   ├── useAuth.ts
│   └── useFetch.ts
│
├── types/                       # TypeScript type definitions
│   ├── user.ts
│   └── api.ts
│
├── styles/                      # Global styles
│   └── globals.css
│
└── env.ts                       # Environment variables with validation
```

**Rationale:** This structure separates concerns—app/ contains only routing, components are reusable, lib/ contains business logic. This scales to larger projects without becoming unwieldy. Route groups ((auth), (marketing)) organize routes without affecting URLs.

### Pattern 1: ESLint 9 Flat Config Setup

**What:** ESLint 9 uses a single `eslint.config.mjs` file (JavaScript, not JSON) that exports an array of configuration objects. No more .eslintrc, .eslintrc.json, or .eslintrc.yml.

**When to use:** Always, for any new Next.js 15+ project. Old .eslintrc format is deprecated and will not work.

**Example:**

```javascript
// eslint.config.mjs (source: https://nextjs.org/docs/app/api-reference/config/eslint)
import { defineConfig, globalIgnores } from 'eslint/config'
import nextVitals from 'eslint-config-next/core-web-vitals'
import prettierConfig from 'eslint-config-prettier/flat'

export default [
  // Ignore patterns
  globalIgnores([
    '.next/**',
    'node_modules/**',
    'out/**',
    'build/**',
    'dist/**',
    'next-env.d.ts',
    '.git/**',
  ]),

  // Next.js + React + Hooks rules (core-web-vitals is stricter)
  ...nextVitals,

  // Prettier must be LAST to disable conflicting rules
  prettierConfig,
]
```

**Key points:**
- Use `eslint-config-next/core-web-vitals` (not base) to catch Core Web Vitals issues as errors
- Use `eslint-config-prettier/flat` (not the old path) for flat config compatibility
- Position prettier config LAST in array (override order matters)
- Use `globalIgnores()` instead of .eslintignore

### Pattern 2: TypeScript Strict Mode with Next.js

**What:** Enable TypeScript's strict type checking mode plus 3-4 additional strict options for maximum type safety.

**When to use:** Always enable for new Next.js projects. Catch errors at compile-time, not runtime.

**Example:**

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "jsx": "preserve",
    "module": "ESNext",
    "moduleResolution": "bundler",

    // ===== STRICT MODE (all 8 strict options enabled)
    "strict": true,

    // ===== RECOMMENDED ADDITIONS (beyond strict)
    "noUncheckedIndexedAccess": true,    // x[y] might be undefined
    "noImplicitReturns": true,            // All code paths must return
    "noFallthroughCasesInSwitch": true,   // Switch cases must break/return
    "noImplicitOverride": true,           // Must mark @override explicitly
    "skipLibCheck": true,                 // Skip type-checking of declaration files (faster builds)
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx"],
  "exclude": ["node_modules", ".next", "out", "build"],
}
```

**What strict: true enables:**
- `noImplicitAny` - Error on inferred `any` types
- `noImplicitThis` - Error on `this` with inferred `any`
- `strictNullChecks` - `null` and `undefined` are distinct types
- `strictFunctionTypes` - Strict checking of function parameter types
- `strictBindCallApply` - Strict checking of `.bind()`, `.call()`, `.apply()`
- `strictPropertyInitialization` - Properties must be initialized in constructor
- `alwaysStrict` - Parse in strict mode, emit "use strict"
- `useUnknownInCatchVariables` - Catch parameters are `unknown`, not `any`

**Recommended additions:**
- `noUncheckedIndexedAccess` - Prevents accessing array/object by index without bounds checking (catches many runtime bugs)
- `noImplicitReturns` - Every code path must return a value
- `noFallthroughCasesInSwitch` - Switch statement cases must break or return
- `noImplicitOverride` - Must explicitly mark overridden methods with `@override`

### Pattern 3: Prettier Configuration (Minimal)

**What:** Prettier formats code automatically; configure only formatting preferences (spacing, quotes, etc), not style rules. Let ESLint handle style.

**When to use:** Always, paired with ESLint. Prettier handles the "how" (formatting), ESLint handles the "what" (quality).

**Example:**

```json
// .prettierrc.json (minimal, opinionated)
{
  "semi": true,                    // Require semicolons
  "singleQuote": true,             // Use single quotes
  "tabWidth": 2,                   // 2 spaces per indent
  "trailingComma": "es5",          // Trailing commas where valid in ES5
  "bracketSpacing": true,          // { foo: bar } not {foo: bar}
  "arrowParens": "always",         // (x) => x not x => x
  "printWidth": 100                // Wrap at 100 chars
}
```

**Why minimal:** Prettier's philosophy is "stop debating formatting." Pick defaults and move on. Don't customize beyond this unless there's a specific pain point.

### Pattern 4: Husky + lint-staged for Pre-Commit Hooks

**What:** Husky intercepts git pre-commit, lint-staged runs checks only on staged files, preventing bad commits.

**When to use:** Always, for any team project. Stops mistakes before they reach the repo.

**Setup:**

```bash
# Initialize Husky
npx husky install

# Create pre-commit hook
npx husky add .husky/pre-commit "npx lint-staged"
```

**Configuration:**

```json
// .lintstagedrc.json (source: https://github.com/lint-staged/lint-staged)
{
  "*.{ts,tsx,js,jsx}": [
    "eslint --fix",                    // Fix lint issues automatically
    "prettier --write"                 // Format code
  ],
  "*.json": ["prettier --write"],
  "*.md": ["prettier --write"],
  "*.css": ["prettier --write"]
}
```

**In package.json:**

```json
{
  "scripts": {
    "prepare": "husky install",        // Auto-runs after pnpm install
    "lint": "eslint . --fix",          // Manual lint + fix
    "type-check": "tsc --noEmit",      // Manual type-check
    "format": "prettier --write ."     // Manual format
  }
}
```

**Flow:**
1. Developer runs `git commit -m "..."`
2. Husky pre-commit hook fires
3. lint-staged runs ESLint (--fix) + Prettier on staged files only
4. If linting fails, commit is blocked; developer fixes and retries
5. If linting passes, commit succeeds

### Pattern 5: GitHub Actions Workflows

**What:** Automate linting, type-checking, and testing on every PR and push to main.

**When to use:** Always, for any project with PR-based workflow. Enforces quality gates before merge.

**Workflow structure:**

```yaml
# .github/workflows/ci.yml
name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: 9
      - uses: actions/setup-node@v4
        with:
          node-version: '22'
          cache: 'pnpm'
      - run: pnpm install
      - run: pnpm lint

  type-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: 9
      - uses: actions/setup-node@v4
        with:
          node-version: '22'
          cache: 'pnpm'
      - run: pnpm install
      - run: pnpm type-check

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: 9
      - uses: actions/setup-node@v4
        with:
          node-version: '22'
          cache: 'pnpm'
      - run: pnpm install
      - run: pnpm test
```

**In your GitHub repo settings:**
- Go to Settings → Branches → Branch protection rules
- Require "CI / lint", "CI / type-check", "CI / test" to pass before merge
- Now no one can merge code that fails linting or type-checking

### Pattern 6: Vercel Preview Deployments

**What:** Automatically deploy every PR to a preview URL on Vercel before production.

**Options:**

**Option A: Vercel's Built-in Git Integration (Easiest)**
- Connect your GitHub repo to Vercel in dashboard
- Vercel automatically deploys every push and PR
- No workflow needed; preview URLs appear on PRs automatically

**Option B: GitHub Actions + Vercel Action (More Control)**
- Use `vercel/vercel-action` on GitHub Marketplace
- Deploy only on specific conditions
- Post preview URL as PR comment

```yaml
# .github/workflows/deploy.yml
name: Deploy Preview

on:
  pull_request:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: vercel/action@master
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
```

**Recommendation:** Use Option A (built-in) unless you have advanced CI/CD needs.

### Anti-Patterns to Avoid

- **Old .eslintrc format with flat config:** Causes "plugin not detected" errors. Always use eslint.config.mjs.
- **Positioning Prettier before other configs:** Will not override conflicting rules. Always place last in the config array.
- **Using eslint-plugin-prettier instead of eslint-config-prettier:** Slower, produces excessive warnings, more complex. Use eslint-config-prettier with /flat suffix.
- **Committing with broken types:** Husky prevents this, but don't bypass with `git commit --no-verify`.
- **Installing ESLint in root when using monorepo with Next.js in subdirectory:** Set rootDir in eslint config to point to the Next.js app.
- **Mixing legacy and flat config formats:** Will cause conflicts and hard-to-debug errors. Pick one (flat is mandatory for ESLint 9).

## Don't Hand-Roll

Problems that look simple but have existing, battle-tested solutions:

| Problem | Don't Build | Use Instead | Why |
|---------|------------|-------------|-----|
| Preventing broken commits | Shell script in .git/hooks | Husky + lint-staged | Husky auto-installs on clone; lint-staged only checks staged files (fast); industry standard for 10+ years |
| Disabling ESLint rules that conflict with Prettier | Manual rule-by-rule configuration | eslint-config-prettier/flat | Maintains rule disabled list; automatically handles plugin rules; updates with Prettier/ESLint changes |
| Managing environment variables safely | Hardcoded strings, process.env direct access | Zod/TypeScript validation | Type-safe env access; catches missing vars at startup; validates var format |
| Running checks on staged files | Scan entire repo, or manually select | lint-staged | Only lints changed files; dramatically faster; matches git workflow |
| Enforcing code style | Multiple conflicting ESLint rules | Prettier (single source of truth) | One tool for formatting; eliminates debates; ESLint handles quality, Prettier handles style |

**Key insight:** These are solved problems with mature, well-maintained solutions. The cost of hand-rolling (maintenance, edge cases, team coordination) far exceeds adoption cost.

## Common Pitfalls

### Pitfall 1: "Plugin @next/eslint-plugin-next was not detected" Error

**What goes wrong:** ESLint can't find the Next.js plugin. Usually happens when:
- Upgrading from old .eslintrc to flat config but old config file still present
- Old .eslintrc has `plugins: ["@next/next"]` (old format) mixed with new flat config
- eslint-config-next not installed

**Why it happens:** ESLint 9 completely changed the plugin loading system. Old string-based plugin specs don't work in flat config.

**How to avoid:**
1. Delete all old .eslintrc, .eslintrc.json, .eslintrc.yml files
2. Create eslint.config.mjs using the example above
3. Verify eslint-config-next is installed: `pnpm list eslint-config-next`
4. Don't mix old and new formats

**Warning signs:**
- ESLint config validation error messages
- Plugin not appearing in `eslint --debug` output
- Linting works locally but fails in CI

**Prevention:**
```bash
# Verify no old config files exist
find . -name ".eslintrc*" -type f
# Should return nothing

# Verify correct packages installed
pnpm list | grep eslint
```

### Pitfall 2: ESLint and Prettier Formatting Conflicts

**What goes wrong:** ESLint enforces a style rule (e.g., single quotes) that conflicts with Prettier's format (double quotes). Running Prettier then ESLint causes conflicts; files never "pass."

**Why it happens:** Historically, developers used eslint-plugin-prettier which tried to make ESLint emit Prettier's format. This creates a circular problem.

**How to avoid:**
- Use eslint-config-prettier/flat (not eslint-plugin-prettier)
- Position prettier config LAST in eslint.config.mjs array
- Configure Prettier in .prettierrc.json for styling preferences
- Configure ESLint for code quality only, not styling

**Warning signs:**
- Running Prettier changes code, then ESLint complains about the same code
- Infinite loop of formatting and linting fixes
- eslint-plugin-prettier in package.json

**Prevention:**
```bash
# Verify only eslint-config-prettier is installed (NOT eslint-plugin-prettier)
pnpm list | grep prettier

# Run both tools and verify no conflicts
pnpm lint --fix  # ESLint
pnpm format      # Prettier
pnpm lint        # ESLint again - should pass with no changes
```

### Pitfall 3: TypeScript Errors Not Caught by ESLint

**What goes wrong:** Code passes ESLint but fails TypeScript compilation. Variables typed incorrectly, missing null checks, unused variables.

**Why it happens:** ESLint lints syntax and patterns; TypeScript checks types. They're complementary, not redundant. ESLint can't catch type errors without a separate type-check step.

**How to avoid:**
1. Enable TypeScript strict mode in tsconfig.json
2. Add type-check to CI/CD workflows (separate from linting)
3. Run `tsc --noEmit` in pre-commit (optional but recommended)
4. Configure your editor to show TypeScript errors in real-time

**Warning signs:**
- ESLint passes but `npm run build` fails with TypeScript errors
- Type-related bugs only caught in production
- Team doesn't run type-check locally

**Prevention:**
```bash
# Add to package.json scripts
"type-check": "tsc --noEmit",

# Add to .lintstagedrc.json
{
  "*.{ts,tsx}": ["tsc --noEmit --noEmitOnError"]
}

# Add to GitHub Actions workflow
- run: pnpm type-check
```

### Pitfall 4: Husky Hooks Not Running After Clone

**What goes wrong:** Team member clones repo and commits without pre-commit hooks firing. Bad code gets merged.

**Why it happens:** Git hooks are local; they must be reinstalled on each clone. Without automation, this step is forgotten.

**How to avoid:**
1. Add `"prepare": "husky install"` to package.json scripts
2. When team runs `pnpm install`, prepare script runs automatically
3. Husky installs hooks without manual intervention

**Warning signs:**
- Developers pushing code with linting errors
- Husky hooks missing on fresh clone: `ls -la .husky/` shows empty directory

**Prevention:**
```json
// package.json
{
  "scripts": {
    "prepare": "husky install"
  }
}
```

### Pitfall 5: ESLint Config Applies Globally But Should Be Scoped

**What goes wrong:** A strict ESLint rule (e.g., forbidding window access) is applied to server components, where it shouldn't apply. Developers disable the rule globally instead of scoping it.

**Why it happens:** Flat config syntax for rule scoping can be confusing. Developers take the shortcut of disabling rules outright.

**How to avoid:**
1. Learn to scope rules using `files` and `ignores` properties in flat config
2. Scope strict rules only to where they apply (e.g., client components only)

**Example:**

```javascript
// eslint.config.mjs - WRONG: disables rule everywhere
{
  rules: {
    "no-restricted-globals": "off"  // Now window is allowed in server components!
  }
}

// CORRECT: scope to client components only
{
  files: ["**/*client.ts", "**/*client.tsx"],  // Client component files
  rules: {
    // Rules for client-only code
  }
}
```

**Warning signs:**
- Rules disabled with comments like `// eslint-disable-next-line`
- Rules disabled globally in config even though they only apply to some files

### Pitfall 6: React 19 Hooks Rules Not Enforced

**What goes wrong:** Code violates `exhaustive-deps` rule but linting passes. Hooks behave unexpectedly at runtime due to missing dependencies.

**Why it happens:** If eslint-plugin-react-hooks is outdated or not included in config, new React 19 patterns aren't caught.

**How to avoid:**
1. Ensure eslint-config-next/core-web-vitals is installed and used
2. Verify eslint-plugin-react-hooks is v5.0.0+: `pnpm list eslint-plugin-react-hooks`
3. Check ESLint output includes react-hooks rules: `eslint --debug | grep react-hooks`

**Warning signs:**
- Hooks with missing dependency warnings not caught
- ESLint rules report doesn't mention react-hooks

**Prevention:**
```bash
# Verify versions
pnpm list eslint-plugin-react-hooks  # Should be 5.0.0+
pnpm list @next/eslint-plugin-next   # Latest

# Run ESLint with verbose output
npx eslint . --debug 2>&1 | grep -i "react-hooks"
```

## Code Examples

### ESLint 9 Flat Config with TypeScript (Verified)

**Source:** [Next.js ESLint Configuration Docs](https://nextjs.org/docs/app/api-reference/config/eslint)

```javascript
// eslint.config.mjs
import { defineConfig, globalIgnores } from 'eslint/config'
import nextVitals from 'eslint-config-next/core-web-vitals'
import tseslint from 'typescript-eslint'
import prettierConfig from 'eslint-config-prettier/flat'

export default [
  // Ignore patterns
  globalIgnores([
    '.next/**',
    'node_modules/**',
    'out/**',
    'build/**',
    'dist/**',
    '.git/**',
    'next-env.d.ts',
  ]),

  // TypeScript-specific configuration
  {
    files: ['**/*.ts', '**/*.tsx'],
    languageOptions: {
      parser: tseslint.parser,
      parserOptions: {
        project: true,
      },
    },
  },

  // Next.js + React configuration (strict with Core Web Vitals)
  ...nextVitals,

  // Prettier (must be LAST)
  prettierConfig,
]
```

### TypeScript Strict Config (Verified)

**Source:** [TypeScript Compiler Options](https://www.typescriptlang.org/tsconfig/strict)

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "jsx": "preserve",
    "module": "ESNext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,

    // ===== STRICT MODE
    "strict": true,

    // ===== RECOMMENDED ADDITIONS
    "noUncheckedIndexedAccess": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "noImplicitOverride": true,

    // ===== PERFORMANCE
    "skipLibCheck": true,
    "incremental": true,

    // ===== PATH ALIASES (for cleaner imports)
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx"],
  "exclude": ["node_modules", ".next", "out", "build", "dist"]
}
```

### Prettier + Husky + lint-staged Integration

**Source:** [Husky Docs](https://typicode.github.io/husky/), [lint-staged Docs](https://github.com/lint-staged/lint-staged)

```json
// .lintstagedrc.json
{
  "*.{ts,tsx,js,jsx}": [
    "eslint --fix --max-warnings 0",
    "prettier --write"
  ],
  "*.{json,md,yml,yaml}": ["prettier --write"],
  "*.css": ["prettier --write"]
}
```

```json
// package.json (excerpt)
{
  "scripts": {
    "prepare": "husky install",
    "lint": "eslint . --max-warnings 0",
    "lint:fix": "eslint . --fix",
    "type-check": "tsc --noEmit",
    "format": "prettier --write .",
    "format:check": "prettier --check ."
  }
}
```

```bash
#!/bin/sh
# .husky/pre-commit (auto-generated by husky, run once)
. "$(dirname "$0")/_/husky.sh"

npx lint-staged
```

### GitHub Actions CI Workflow

**Source:** [GitHub Actions Best Practices](https://docs.github.com/en/actions/guides)

```yaml
# .github/workflows/ci.yml
name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  lint:
    name: Lint
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: 9
      - uses: actions/setup-node@v4
        with:
          node-version: '22'
          cache: 'pnpm'
      - run: pnpm install --frozen-lockfile
      - run: pnpm lint

  type-check:
    name: Type Check
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: 9
      - uses: actions/setup-node@v4
        with:
          node-version: '22'
          cache: 'pnpm'
      - run: pnpm install --frozen-lockfile
      - run: pnpm type-check

  test:
    name: Test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: 9
      - uses: actions/setup-node@v4
        with:
          node-version: '22'
          cache: 'pnpm'
      - run: pnpm install --frozen-lockfile
      - run: pnpm test --run  # --run for CI (no watch mode)

  build:
    name: Build
    runs-on: ubuntu-latest
    needs: [lint, type-check]  # Run after linting and type-check
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v2
        with:
          version: 9
      - uses: actions/setup-node@v4
        with:
          node-version: '22'
          cache: 'pnpm'
      - run: pnpm install --frozen-lockfile
      - run: pnpm build
```

## State of the Art

| Old Approach (2024) | Current Approach (2026) | When Changed | Impact |
|---------------------|------------------------|--------------|--------|
| `.eslintrc.json` or `.eslintrc.js` | `eslint.config.mjs` (flat config) | ESLint 9.0 (Apr 2024) | All configs must be rewritten; no backwards compatibility after ESLint 9 |
| `next lint` command in scripts | Direct `eslint` CLI invocation | Next.js 15.5+ | next lint removed in Next.js 16; must use npx eslint directly |
| eslintrc with `env` property | flat config with `languageOptions` | ESLint 9.0 | Global state replaced with explicit object properties |
| Old `extends` syntax | Import + spread operator | ESLint 9.0 | Configs become explicit JavaScript objects |
| eslint-plugin-prettier (slower) | eslint-config-prettier/flat (recommended) | 2024 | Prettier author now recommends config-prettier, not plugin-prettier |
| Manual pre-commit shell scripts | Husky + Git hooks automation | 2024 | Husky 9.x standard; auto-installs on clone |
| ESLint 8.x | ESLint 9.x (flat config mandatory) | Apr 2024 | Breaking changes; no new ESLint 8 releases after 8.57.0 |

**Deprecated/outdated:**
- **Old .eslintrc formats (eslintrc):** Officially deprecated; will not work with ESLint 9.x without ESLINT_USE_FLAT_CONFIG=false escape hatch (temporary)
- **eslint-plugin-prettier:** Slower, more complex than eslint-config-prettier; Prettier team discourages use
- **next lint command:** Deprecated in Next.js 15.5, removed in Next.js 16; use npx eslint instead
- **Old Husky installation methods:** Pre-Husky 9.x used .git/hooks directly; current version auto-installs

## Open Questions

1. **React 19 Compiler Lint Rules**
   - What we know: React 19's new compiler requires lint rules to avoid unsafe patterns, but these rules are still being finalized as of Feb 2026
   - What's unclear: Exact rules, stability, how they integrate with eslint-config-next
   - Recommendation: Monitor https://react.dev/compiler for updates; once stabilized, add to ESLint config

2. **ESLint Flat Config Adoption in Ecosystem**
   - What we know: ESLint 9 is mandatory; all packages have migrated or will migrate
   - What's unclear: Some third-party packages may still provide old .eslintrc configs; how to handle conflicts
   - Recommendation: If a third-party provides old config, convert using ESLint migration tool or ignore it

3. **Monorepo Root ESLint vs Per-Package**
   - What we know: Can have single root eslint.config.mjs or per-package configs
   - What's unclear: Best practice for shared rules in pnpm workspaces
   - Recommendation: Start with single root config; if needed, split per-package with shared extends

## Sources

### Primary (HIGH confidence)

- [Next.js 15 ESLint Configuration Docs](https://nextjs.org/docs/app/api-reference/config/eslint) - Authoritative on eslint-config-next setup, flat config requirements
- [ESLint 9 Migration Guide](https://eslint.org/docs/latest/use/migrate-to-9.0.0) - Official ESLint documentation on flat config migration
- [TypeScript Strict Mode Configuration](https://www.typescriptlang.org/tsconfig/strict) - Official TypeScript docs on strict options
- [eslint-config-prettier Repository](https://github.com/prettier/eslint-config-prettier) - Official Prettier integration documentation
- [Next.js 15 Project Structure Docs](https://nextjs.org/docs/app/getting-started/project-structure) - Official Next.js folder organization recommendations
- [Prettier + ESLint Integration Guide](https://prettier.io/docs/integrating-with-linters) - Official Prettier documentation on conflict resolution

### Secondary (MEDIUM confidence)

- [pnpm vs npm Benchmarks 2026](https://www.thelinuxcode.com/pnpm-vs-npm-in-2026-faster-installs-safer-dependency-graphs-and-a-practical-migration-path) - WebSearch verified with official pnpm docs; 12.4s vs 46.1s benchmarks from Jan 2026
- [Husky + lint-staged Best Practices](https://betterstack.com/community/guides/scaling-nodejs/husky-and-lint-staged/) - WebSearch with industry consensus; verified across multiple sources
- [GitHub Actions Next.js CI/CD Patterns](https://blog.devops.dev/automating-linting-and-building-in-next-js-using-github-actions-0167f63a170f) - WebSearch; patterns verified by multiple sources

### Tertiary (LOW confidence)

- Community blog posts on ESLint 9 migration challenges (flagged as needing validation; used for common pitfalls section)
- Medium articles on React 19 hook rules (recent, but not yet officially finalized; compiler lint rules still evolving)

## Metadata

**Confidence breakdown:**
- Standard stack: **HIGH** - Sourced from official Next.js, ESLint, TypeScript, Prettier docs
- Architecture patterns: **HIGH** - Official Next.js docs + repeated across multiple authoritative sources
- ESLint configuration: **HIGH** - Official ESLint 9 migration guide + Next.js docs
- Pitfalls: **MEDIUM-HIGH** - Sourced from GitHub issues, WebSearch, verified with official docs
- Vercel deployments: **MEDIUM** - Official Vercel docs verify approach; GitHub Actions implementation from community sources

**Research date:** 2026-02-05
**Valid until:** 2026-03-05 (30 days; ESLint/Next.js tooling is stable, but React 19 compiler rules may evolve)

**Known limitations:**
- React 19 Compiler lint rules still being finalized; not fully documented yet
- Monorepo + linting patterns emerging; not yet stabilized in ecosystem
- Biome as alternative to ESLint not fully evaluated (immature, not widely adopted for Next.js yet)

