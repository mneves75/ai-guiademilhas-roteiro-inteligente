---
phase: 01-foundation-code-quality
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [tsconfig.json, eslint.config.mjs, .prettierrc.json, prettier.config.mjs, .eslintignore, package.json]
autonomous: true

must_haves:
  truths:
    - "Developer opens any .ts/.tsx file and sees no TypeScript errors (strict mode enforced)"
    - "Developer saves a file with `any` type and ESLint immediately flags it as an error"
    - "Developer saves unformatted code and Prettier formats it (via editor integration)"
    - "Project can build without TypeScript errors (`pnpm build` succeeds)"
    - "ESLint rules are configured for Next.js 15 + React 19 (no legacy rules)"
  artifacts:
    - path: "tsconfig.json"
      provides: "TypeScript configuration with strict mode + strict option extensions"
      contains: ["strict: true", "noUncheckedIndexedAccess"]
    - path: "eslint.config.mjs"
      provides: "ESLint 9 flat config with @next/eslint-plugin-next + eslint-config-prettier"
      contains: ["import nextPlugin from", "eslint-config-prettier/flat"]
    - path: ".prettierrc.json"
      provides: "Prettier formatting rules aligned with ESLint"
      exports: ["printWidth", "tabWidth", "semi", "singleQuote"]
    - path: "prettier.config.mjs"
      provides: "Alternative Prettier config in JS format"
      min_lines: 5
  key_links:
    - from: "package.json"
      to: "eslint.config.mjs"
      via: "eslint + @typescript-eslint/parser installed as dev dependencies"
      pattern: "devDependencies.*eslint"
    - from: "eslint.config.mjs"
      to: ".prettierrc.json"
      via: "flat config includes eslint-config-prettier/flat to disable formatting rules"
      pattern: "eslint-config-prettier/flat"
    - from: "tsconfig.json"
      to: "eslint.config.mjs"
      via: "ESLint parser points to tsconfig.json for TypeScript options"
      pattern: "tsconfig.json"
---

<objective>
Configure TypeScript strict mode, ESLint 9 flat config with Next.js/React 19 rules, and Prettier formatting to establish code quality baseline. Ensure all tooling works together without conflicts.

Purpose: Code quality tooling prevents bugs early, standardizes code style, and enforces team patterns. This runs for every file written in Phases 2-12.

Output: Committed config files ready for developers to write code immediately after `pnpm install`.
</objective>

<execution_context>
@/Users/mneves/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mneves/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-code-quality/01-RESEARCH.md

Reference: Next.js 15 official TypeScript docs, ESLint 9 flat config guide, Prettier + ESLint integration docs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure TypeScript strict mode</name>
  <files>tsconfig.json</files>
  <action>
    Create/update tsconfig.json in project root with TypeScript strict mode enabled. Set:
    - "strict": true (enables all strict type checking)
    - "noUncheckedIndexedAccess": true (requires index access checks)
    - "noImplicitReturns": true (functions must explicitly return)
    - "noFallthroughCasesInSwitch": true (switch cases must break/return)
    - "skipLibCheck": true (skip type checking of declaration files for speed)
    - "target": "ES2020" (modern target for Next.js 15)
    - "lib": ["ES2020", "DOM", "DOM.Iterable"] (includes DOM types for React)
    - "jsx": "preserve" (let Next.js handle JSX)
    - "moduleResolution": "bundler" (Next.js recommended)
    - "paths": pointing to src/* if using src/ directory or relative to project root

    Include: "include": ["src/**/*.ts", "src/**/*.tsx", "next-env.d.ts"]
    Include: "exclude": ["node_modules", ".next", "dist"]
  </action>
  <verify>
    Run: `pnpm tsc --noEmit`
    Should complete without errors (validates tsconfig syntax).
    Check: tsconfig.json exists and contains "strict": true.
  </verify>
  <done>
    tsconfig.json committed with strict: true + extended strict options.
    Any new file with `any` type will fail TypeScript check.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure ESLint 9 flat config with Next.js rules</name>
  <files>eslint.config.mjs, .eslintignore</files>
  <action>
    Create eslint.config.mjs in project root (ESLint 9 flat config format). Import and configure:
    - Import @next/eslint-plugin-next (handles Next.js-specific rules)
    - Import eslint-plugin-react (handles React rules)
    - Import eslint-plugin-react-hooks@5.x+ (handles Hooks rules)
    - Import @typescript-eslint/eslint-plugin and @typescript-eslint/parser (TypeScript support)
    - Import eslint-config-prettier/flat (disable formatting rules - MUST be last)

    Configuration order (critical):
    1. JavaScript files config
    2. TypeScript files config (using @typescript-eslint/parser, languageOptions.parserOptions.project: true)
    3. JSX files config with React settings
    4. Next.js plugin config (@next/eslint-plugin-next/core-web-vitals)
    5. eslint-config-prettier/flat (LAST - disables all formatting rules)

    Enable rules:
    - @next/eslint-plugin-next (all recommended Next.js rules)
    - eslint-plugin-react-hooks (all hooks rules)
    - @typescript-eslint/no-explicit-any (CRITICAL: ban any type usage)

    Create .eslintignore to exclude:
    ```
    node_modules/
    .next/
    dist/
    build/
    .vercel/
    coverage/
    ```

    Reference: https://eslint.org/docs/latest/use/configure/configuration-files (flat config format)
    Note: Do NOT use eslint-plugin-prettier (deprecated pattern); use eslint-config-prettier instead.
  </action>
  <verify>
    Run: `pnpm eslint --version` → confirms v9.x installed
    Run: `pnpm eslint --print-config src/` → shows flat config is loaded
    Run: `pnpm eslint . --max-warnings=0` → should report only config/dependency errors (no actual linting yet)
    Check: eslint.config.mjs exists and can be parsed without errors
  </verify>
  <done>
    ESLint 9 flat config committed with @next/eslint-plugin-next, React Hooks, @typescript-eslint plugins.
    Rule @typescript-eslint/no-explicit-any is enabled (blocks `any` type usage).
  </done>
</task>

<task type="auto">
  <name>Task 3: Configure Prettier formatting</name>
  <files>.prettierrc.json, prettier.config.mjs</files>
  <action>
    Create both .prettierrc.json and prettier.config.mjs (optional dual format support).

    .prettierrc.json should contain:
    ```json
    {
      "printWidth": 100,
      "tabWidth": 2,
      "useTabs": false,
      "semi": true,
      "singleQuote": true,
      "quoteProps": "as-needed",
      "jsxSingleQuote": false,
      "trailingComma": "es5",
      "bracketSpacing": true,
      "bracketSameLine": false,
      "arrowParens": "always",
      "requirePragma": false,
      "insertPragma": false,
      "proseWrap": "preserve",
      "htmlWhitespaceSensitivity": "css",
      "vueIndentScriptAndStyle": false,
      "endOfLine": "lf"
    }
    ```

    prettier.config.mjs (JS alternative) should export same config as default.

    Rationale:
    - printWidth: 100 (reasonable balance for Next.js code)
    - singleQuote: true (JavaScript preference)
    - trailingComma: es5 (safe for ES5 compatibility)
    - semi: true (explicit; matches TypeScript style)
    - endOfLine: lf (Unix line endings for git consistency)

    Create .prettierignore to exclude:
    ```
    node_modules/
    .next/
    dist/
    build/
    .vercel/
    coverage/
    pnpm-lock.yaml
    ```
  </action>
  <verify>
    Run: `pnpm prettier --version` → confirms v3.x installed
    Run: `pnpm prettier --check .` → checks formatting without changes (will complain about unformatted files if they exist)
    Check: .prettierrc.json exists and is valid JSON
    Check: prettier.config.mjs exists and can be imported without errors
  </verify>
  <done>
    Prettier config committed with standard settings.
    Developer can format code via `pnpm prettier --write .` or editor integration.
  </done>
</task>

<task type="auto">
  <name>Task 4: Update package.json with script hooks and dependencies</name>
  <files>package.json</files>
  <action>
    Update package.json to add:

    Scripts section (add these):
    ```json
    "scripts": {
      "lint": "eslint . --max-warnings=0",
      "lint:fix": "eslint . --fix",
      "format": "prettier --write .",
      "format:check": "prettier --check .",
      "type-check": "tsc --noEmit",
      "dev": "next dev",
      "build": "next build",
      "start": "next start"
    }
    ```

    DevDependencies (ensure these are present):
    - eslint@^9.x
    - @typescript-eslint/eslint-plugin@^7.x
    - @typescript-eslint/parser@^7.x
    - eslint-config-next@^15.x (includes @next/eslint-plugin-next + eslint-plugin-react + eslint-plugin-react-hooks)
    - prettier@^3.x
    - eslint-config-prettier@^9.x (use /flat variant in eslint.config.mjs)

    Verify all are listed as devDependencies (not dependencies).

    If the package.json doesn't already have these, they'll be installed in a later task when running pnpm install.
  </action>
  <verify>
    Check: package.json exists and can be parsed as valid JSON
    Check: "scripts" section contains lint, lint:fix, format, format:check, type-check
    Check: devDependencies section lists eslint, @typescript-eslint/*, prettier, eslint-config-*
  </verify>
  <done>
    package.json updated with quality check scripts and dev dependencies listed.
    Developer can run `pnpm lint` and `pnpm format` for checking/fixing.
  </done>
</task>

</tasks>

<verification>
After all tasks:
1. Run `pnpm install` to ensure all ESLint + Prettier dependencies resolve
2. Run `pnpm type-check` → should pass (no TypeScript errors yet)
3. Run `pnpm lint` → should pass (no actual code to lint yet, just config validation)
4. Run `pnpm format:check` → may report unformatted files (expected before lint-staged setup)
5. Run `git diff` → should show new config files only (eslint.config.mjs, .prettierrc.json, tsconfig.json updated)

Success: All tooling is installed and configured. Ready for Plan 02 (GitHub Actions workflows).
</verification>

<success_criteria>
1. TypeScript strict mode enabled: `pnpm type-check` passes
2. ESLint configured: `pnpm eslint --version` shows v9.x; `pnpm lint` validates config
3. Prettier configured: `pnpm prettier --version` shows v3.x; `pnpm format:check` works
4. No `any` type rule enabled: ESLint would flag `const x: any = 5;` as error (when real code exists)
5. All config files committed and ready for next phase
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-code-quality/01-01-SUMMARY.md` with:
- Frontmatter: status=complete, artifacts_created=[config files], tech_stack.added=[ESLint 9, Prettier 3, TypeScript 5+]
- Summary of what was configured
- Link to executed tasks
- Ready for Plan 02
</output>
