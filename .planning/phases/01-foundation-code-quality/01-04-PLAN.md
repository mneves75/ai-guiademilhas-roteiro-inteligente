---
phase: 01-foundation-code-quality
plan: 04
type: execute
wave: 3
depends_on: ["01-01", "01-02", "01-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Developer can clone project and run `pnpm install && pnpm dev` without errors"
    - "All three GitHub Actions workflows pass: lint, type-check, test"
    - "Pre-commit hook prevents commits with TypeScript/ESLint violations"
    - "Vercel preview deployment was created on test PR"
    - "Documentation explains how to use quality tooling"
  artifacts:
    - path: "DEVELOPMENT.md or README.md"
      provides: "Documentation for developers on how to run quality checks locally"
      contains: ["pnpm lint", "pnpm type-check", "pnpm format"]
  key_links:
    - from: "Developer workflow"
      to: "Pre-commit hook → GitHub Actions → Vercel preview"
      via: "Complete quality enforcement pipeline from local to production"
      pattern: "All steps functional"
---

<objective>
Verify that all Phase 1 requirements work end-to-end: local tooling, pre-commit hooks, GitHub Actions CI/CD, and Vercel deployments. Confirm no regressions and document developer workflow.

Purpose: Quality gates are only valuable if they actually prevent bad code. This verification proves the full pipeline works before moving to Phase 2.

Output: Verified Phase 1 with documentation. Ready for Phase 2 (Database & Schema).
</objective>

<execution_context>
@/Users/mneves/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mneves/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-code-quality/01-01-SUMMARY.md
@.planning/phases/01-foundation-code-quality/01-02-SUMMARY.md
@.planning/phases/01-foundation-code-quality/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify local tooling and create developer documentation</name>
  <files>DEVELOPMENT.md (or update README.md)</files>
  <action>
    Create DEVELOPMENT.md (or add to README.md section) with:

    ```markdown
    # Development Guide

    ## Getting Started

    ### Clone and Setup
    ```bash
    git clone https://github.com/[org]/nextjs-bootstrapped-shipped.git
    cd nextjs-bootstrapped-shipped
    pnpm install        # Installs dependencies + Husky hooks
    pnpm dev             # Starts development server
    ```

    Navigate to http://localhost:3000. Development server should start without errors.

    ### Code Quality

    We enforce code quality at three levels: local, pre-commit, and CI/CD.

    #### Local Development

    Check code quality while developing:
    ```bash
    pnpm lint            # Run ESLint on all files
    pnpm lint:fix        # Auto-fix ESLint violations
    pnpm type-check      # Run TypeScript type checker
    pnpm format          # Format code with Prettier
    pnpm format:check    # Check if code is formatted
    ```

    Run before committing:
    ```bash
    pnpm lint && pnpm type-check && pnpm format
    ```

    #### Pre-Commit Hook

    When you run `git commit`, Husky automatically:
    1. Runs ESLint on changed files (with --fix for auto-corrections)
    2. Runs Prettier on changed files
    3. Blocks commit if violations remain

    You can't accidentally commit bad code.

    #### GitHub Actions CI/CD

    On every PR and push to main/develop:
    1. **Lint workflow**: Runs `pnpm lint` (no warnings allowed)
    2. **Type-check workflow**: Runs `pnpm type-check`
    3. **Test workflow**: Runs `pnpm test` against PostgreSQL

    All three must pass before merge is allowed.

    #### Vercel Preview

    On every PR, Vercel automatically:
    1. Builds the project
    2. Deploys to a preview URL
    3. Posts preview link in PR comments

    Test feature changes in the preview before approving.

    ### Bypassing Hooks (Emergency Only)

    If you absolutely must bypass pre-commit hook (not recommended):
    ```bash
    git commit --no-verify
    ```

    But do NOT do this unless necessary. Commits will likely fail CI/CD.

    ### Environment Variables

    Copy .env.example to .env.local and fill in values:
    ```bash
    cp .env.example .env.local
    ```

    Edit .env.local (never commit this file):
    - DATABASE_URL: PostgreSQL connection string
    - NEXT_PUBLIC_APP_URL: http://localhost:3000 (for development)
    - API keys: Stripe, Resend, etc.

    ### Troubleshooting

    **Pre-commit hook runs but ESLint fails**
    - Hook automatically fixes some issues (indentation, quotes, semicolons)
    - Read error message and fix remaining violations manually
    - Try: `pnpm lint:fix` to auto-fix, then commit again

    **Husky hook not running after clone**
    - Run: `pnpm install` (should install hooks automatically via prepare script)
    - If still not working: `pnpm exec husky install`

    **Type-check fails locally but passes in CI**
    - You may have stale build artifacts: `rm -rf .next && pnpm type-check`

    **Vercel preview not deploying**
    - Check GitHub Settings → Installed GitHub Apps → Vercel is enabled
    - Push a new commit to trigger build

    ### Running Tests

    Tests are configured in Phase 12. For now:
    ```bash
    pnpm test          # Will fail (no test files yet)
    ```

    This is expected. Tests will be added in Phase 12.

    ## Code Style Guidelines

    - **TypeScript strict mode**: All files use strict type checking
    - **No `any` types**: Use `unknown` + type guards instead
    - **Prettier formatting**: 100 char line width, single quotes, 2-space indent
    - **File organization**: Colocate components with tests
    - **Naming**: camelCase for variables/functions, PascalCase for components/types

    See CLAUDE.md for additional guidelines when using Claude for code generation.
    ```

    Commit this documentation to the repo.

    Rationale: Developers need to know how the quality pipeline works and how to interact with it. Good documentation prevents confusion and misuse (like always using --no-verify).
  </action>
  <verify>
    Check: DEVELOPMENT.md or README.md exists and contains setup instructions
    Check: Document explains all tooling: ESLint, Prettier, TypeScript, Husky, GitHub Actions, Vercel
    Check: Document includes "Troubleshooting" section for common issues
    Check: Document discourages --no-verify
  </verify>
  <done>
    Developer documentation created and committed.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete Phase 1 code quality foundation:
    - TypeScript strict mode configured
    - ESLint 9 flat config with @next/eslint-plugin-next
    - Prettier formatting configured
    - Husky pre-commit hooks installed
    - lint-staged running ESLint + Prettier on staged files
    - GitHub Actions workflows: lint, type-check, test
    - Vercel GitHub App connected for preview deployments
    - Developer documentation (DEVELOPMENT.md)
  </what-built>

  <how-to-verify>
    **Verify Phase 1 locally (15-20 min):**

    1. **Clone fresh and install:**
       ```bash
       cd /tmp
       git clone [YOUR_REPO_URL] test-phase1
       cd test-phase1
       pnpm install  # Should not error, hooks installed
       ```
       ✅ Check: pnpm install completes without errors

    2. **Run local tooling:**
       ```bash
       pnpm type-check  # Should pass (no code yet)
       pnpm lint        # Should pass (no code yet)
       pnpm format:check  # Will complain about unformatted files (ok at this stage)
       ```
       ✅ Check: type-check and lint pass; format:check can fail

    3. **Start dev server:**
       ```bash
       pnpm dev
       ```
       ✅ Check: Server starts on http://localhost:3000 without errors

    4. **Test pre-commit hook:**
       - Create a test file: `echo "const x: any = 5;" > test.ts`
       - Try to commit: `git add test.ts && git commit -m "test"`
       - ✅ Check: Commit is BLOCKED by pre-commit hook (ESLint error)
       - Fix: Delete test.ts, `git add -A`, commit succeeds
       - ✅ Check: Commit SUCCEEDS after fix

    5. **Test GitHub Actions (5 min):**
       - Create a test branch: `git checkout -b test-pr`
       - Make a trivial change (e.g., add a comment to README.md)
       - Push: `git push origin test-pr`
       - Open a PR on GitHub
       - ✅ Check: All three workflows run (lint, type-check, test)
       - ✅ Check: All workflows show ✅ (pass) or ⊘ (skipped, ok if no test files)
       - Do NOT merge this PR - just verify workflows passed

    6. **Test Vercel preview (2-3 min):**
       - Wait 30-60 seconds after pushing PR
       - ✅ Check: Vercel posts deployment comment in PR with preview URL
       - ✅ Check: Preview URL shows Next.js home page (or your landing page if added)

    7. **Review documentation:**
       - ✅ Check: DEVELOPMENT.md (or README.md) is clear and complete
       - ✅ Check: Troubleshooting section covers common issues

    **Success Criteria:**
    - [ ] Fresh clone + `pnpm install` completes without errors
    - [ ] Local tooling runs without errors (type-check, lint)
    - [ ] Dev server starts and loads on http://localhost:3000
    - [ ] Pre-commit hook blocks bad commits (actual test with `any` type)
    - [ ] Pre-commit hook allows good commits
    - [ ] All 3 GitHub Actions workflows pass on PR
    - [ ] Vercel creates preview deployment
    - [ ] Documentation is clear and accessible
  </how-to-verify>

  <resume-signal>
    After verification, describe any issues found:
    - "All verified - Phase 1 complete" (proceed to summary)
    - Or list specific failures: "Type-check failed because X", "Vercel didn't deploy because Y", etc.

    If issues found, they'll be addressed before moving to Phase 2.
  </resume-signal>
</task>

</tasks>

<verification>
Phase 1 is complete when:
1. All 10 requirements are covered by Plans 01-03:
   - QUAL-01: TypeScript strict mode ✓ (Plan 01)
   - QUAL-02: ESLint configured ✓ (Plan 01)
   - QUAL-03: Prettier configured ✓ (Plan 01)
   - QUAL-04: Husky installed ✓ (Plan 03)
   - QUAL-05: lint-staged runs ✓ (Plan 03)
   - QUAL-06: No `any` allowed ✓ (Plan 01, ESLint rule)
   - CICD-01: Test workflow ✓ (Plan 02)
   - CICD-02: Lint workflow ✓ (Plan 02)
   - CICD-03: Type-check workflow ✓ (Plan 02)
   - CICD-04: Preview deployments ✓ (Plan 03, Vercel)

2. End-to-end verification passed (this checkpoint)

3. Documentation is in place

Ready for Phase 2: Database & Schema
</verification>

<success_criteria>
1. Developer can clone, install, and run dev server without errors
2. Pre-commit hook blocks commits with TypeScript/ESLint violations
3. All GitHub Actions workflows pass on PR
4. Vercel creates preview deployment on PR
5. Documentation explains the quality pipeline
6. All 10 Phase 1 requirements are met and verified
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-code-quality/01-04-SUMMARY.md` with:
- Frontmatter: status=verified, all_requirements_met=true, phase_complete=true
- Checklist of all 10 requirements verified
- Summary of what was accomplished
- Notes for Phase 2 planning
- Link: Ready for `/gsd:execute-phase 1` → `/gsd:plan-phase 2`
</output>
